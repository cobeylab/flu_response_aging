color = segment, label = isolate_id)) +
geom_point(alpha = 0.4) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.6) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.7) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 5)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'div')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'Top')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/H1N1_HA_genbank_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/H1N1_NA_genbank_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/H1N1_NP_genbank_distances.csv', header= T))
setwd("/Volumes/cobey/mvieira/flu_response_aging/src")
library(cowplot)
#library(ggplot2)
library(dplyr)
# Import H3N2 results
H3N2_HA_genbank_results <- as_tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
H3N2_NA_gisaid_results <- as_tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
H3N2_NP_genbank_results <- as_tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Import H1N1 results
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/H1N1_HA_genbank_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/H1N1_NA_genbank_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/H1N1_NP_genbank_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/H1N1_NP_genbank_distances.csv', header= T))
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_HA_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NA_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NP_distances.csv', header= T))
H1N1_HA_genbank_results
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(subtype~.) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1934)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1934)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1934)
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1977)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1977)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1977)
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
setwd("/Volumes/cobey/mvieira/flu_response_aging/src")
library(cowplot)
#library(ggplot2)
library(dplyr)
# Import H3N2 results (based on KC alignments)
#H3N2_HA_genbank_results <- as_tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
#H3N2_NA_gisaid_results <- as_tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
#H3N2_NP_genbank_results <- as_tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Import H3N2 results
H3N2_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_HA_distances.csv', header= T))
H3N2_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_NA_distances.csv', header= T))
H3N2_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_NP_distances.csv', header= T))
# Import H1N1 results
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_HA_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NA_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NP_distances.csv', header= T))
# Filter H1N1 to keep only sequences from 1934 on (year of the reference sequence)
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1934)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1934)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1934)
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_genbank_results, subtype = 'H3N2', segment = 'NA', database = 'genbank'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
divergence_vs_time_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/divergence_vs_time_plot.pdf', width = 10, height = 6)
plot(divergence_vs_time_plot)
dev.off()
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_genbank_results, subtype = 'H3N2', segment = 'NA', database = 'genbank'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
) %>%
mutate(subtype = factor(subtype, levels = c('H3N2','H1N1'))
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
divergence_vs_time_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/divergence_vs_time_plot.pdf', width = 10, height = 6)
plot(divergence_vs_time_plot)
dev.off()
ggplot(filter(divergence_results, segment == 'NA'), aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
filter(divergence_results, segment == 'NA')
filter(divergence_results, segment == 'NA') %>% select(year)
filter(divergence_results, segment == 'NA') %>% select(year) %>% min()
filter(divergence_results, segment == 'NA') %>% select(year) %>% min(na.rm = T)
filter(divergence_results, segment == 'NA', year == 1934)
filter(divergence_results, segment == 'NA', year == 1935)
library(cowplot)
#library(ggplot2)
library(dplyr)
# Import H3N2 results (based on KC alignments)
#H3N2_HA_genbank_results <- as_tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
#H3N2_NA_gisaid_results <- as_tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
#H3N2_NP_genbank_results <- as_tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Import H3N2 results
H3N2_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_HA_distances.csv', header= T))
H3N2_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_NA_distances.csv', header= T))
H3N2_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_NP_distances.csv', header= T))
# Import H1N1 results
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_HA_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NA_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NP_distances.csv', header= T))
# Filter H1N1 to keep only sequences from 1934 on (year of the reference sequence)
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1934)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1934)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1934)
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_genbank_results, subtype = 'H3N2', segment = 'NA', database = 'genbank'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
) %>%
mutate(subtype = factor(subtype, levels = c('H3N2','H1N1'))
)
ggplot(filter(divergence_results, segment == 'NA'), aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
divergence_vs_time_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/divergence_vs_time_plot.pdf', width = 10, height = 6)
plot(divergence_vs_time_plot)
dev.off()
library(cowplot)
#library(ggplot2)
library(dplyr)
# Import H3N2 results (based on KC alignments)
#H3N2_HA_genbank_results <- as_tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
#H3N2_NA_gisaid_results <- as_tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
#H3N2_NP_genbank_results <- as_tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Import H3N2 results
H3N2_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_HA_distances.csv', header= T))
H3N2_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_NA_distances.csv', header= T))
H3N2_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H3N2_NP_distances.csv', header= T))
# Import H1N1 results
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_HA_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NA_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NP_distances.csv', header= T))
# Filter H1N1 to keep only sequences from 1934 on (year of the reference sequence)
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1977)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1977)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1977)
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_genbank_results, subtype = 'H3N2', segment = 'NA', database = 'genbank'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
) %>%
mutate(subtype = factor(subtype, levels = c('H3N2','H1N1'))
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
divergence_vs_time_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/divergence_vs_time_plot.pdf', width = 10, height = 6)
plot(divergence_vs_time_plot)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
scale_x_discrete(limits = seq(1977,2008,3))
theme(legend.position = 'top')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
scale_x_discrete(limits = seq(1977,2008,3)) +
theme(legend.position = 'top')
divergence_vs_time_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
