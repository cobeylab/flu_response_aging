ylab('\\% amino acid divergence from A/Hong Kong/1-5/1968')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('% amino acid divergence from A/Hong Kong/1-5/1968')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('% amino acid divergence from\nA/Hong Kong/1-5/1968')
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('% amino acid divergence from\nA/Hong Kong/1-5/1968')
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('% amino acid divergence from\nA/Hong Kong/1-5/1968')
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
H3N2_plot
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('% amino acid divergence from\nA/Hong Kong/1-5/1968')
H3N2_plot
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
H3N2_plot
library(ggplot2)
library(cowplot)
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
H3N2_plot
ggsave('../figures/H3N2_divergence_vs_time', H3N2_plot)
library(tidyverse)
library(ggplot2)
library(cowplot)
# Import H3N2 results
H3N2_HA_genbank_results <- as.tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
H3N2_NA_gisaid_results <- as.tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
H3N2_NP_genbank_results <- as.tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'))
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
library(cowplot)
library(dplyr)
# Import H3N2 results
H3N2_HA_genbank_results <- as.tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
H3N2_NA_gisaid_results <- as.tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
H3N2_NP_genbank_results <- as.tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'))
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
setwd("/Volumes/cobey/mvieira/flu_response_aging/src")
library(cowplot)
library(dplyr)
# Import H3N2 results
H3N2_HA_genbank_results <- as.tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
H3N2_NA_gisaid_results <- as.tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
H3N2_NP_genbank_results <- as.tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'))
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
H3N2_HA_genbank_results <- as.tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
library(dplyr)
H3N2_HA_genbank_results <- as.tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
library(cowplot)
library(dplyr)
H3N2_HA_genbank_results <- as.tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
as_tibble()
H3N2_HA_genbank_results <- as_tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
H3N2_NA_gisaid_results <- as_tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
H3N2_NP_genbank_results <- as_tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'))
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
dev.off()
dev.off()
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
?ggsave
library(ggplot2)
?ggsave
library(cowplot)
ggsave('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
save_plot('../figures/H3N2_divergence_vs_time', H3N2_plot,
base_height = 5, base_width = 6)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 6, height = 5)
plot(H3N2_plot)
dev.off()
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer()
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 3)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.3) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.4) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.6) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.7) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 7, height = 5)
plot(H3N2_plot)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 4)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual', palette = 5)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'div')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point() +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 5)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'Top')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth() +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H3N2_plot <- ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
# ggsave crashing for some reason
pdf('../figures/H3N2_divergence_vs_time.pdf', width = 8, height = 6)
plot(H3N2_plot)
dev.off()
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/H1N1_HA_genbank_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/H1N1_NA_genbank_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/H1N1_NP_genbank_distances.csv', header= T))
setwd("/Volumes/cobey/mvieira/flu_response_aging/src")
library(cowplot)
#library(ggplot2)
library(dplyr)
# Import H3N2 results
H3N2_HA_genbank_results <- as_tibble(read.csv('../results/H3N2_HA_genbank_distances.csv', header= T))
H3N2_NA_gisaid_results <- as_tibble(read.csv('../results/H3N2_NA_gisaid_distances.csv', header= T))
H3N2_NP_genbank_results <- as_tibble(read.csv('../results/H3N2_NP_genbank_distances.csv', header= T))
# Import H1N1 results
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/H1N1_HA_genbank_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/H1N1_NA_genbank_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/H1N1_NP_genbank_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/H1N1_NP_genbank_distances.csv', header= T))
H1N1_HA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_HA_distances.csv', header= T))
H1N1_NA_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NA_distances.csv', header= T))
H1N1_NP_genbank_results <- as_tibble(read.csv('../results/genbank_H1N1_NP_distances.csv', header= T))
H1N1_HA_genbank_results
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(subtype~.) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1934)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1934)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1934)
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype) +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top') +
ggtitle('A/H3N2')
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from\nA/Hong Kong/1-5/1968') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
H1N1_HA_genbank_results <- filter(H1N1_HA_genbank_results, year >= 1977)
H1N1_NA_genbank_results <- filter(H1N1_NA_genbank_results, year >= 1977)
H1N1_NP_genbank_results <- filter(H1N1_NP_genbank_results, year >= 1977)
# Merge tibbles
divergence_results <- bind_rows(mutate(H3N2_HA_genbank_results, subtype = 'H3N2', segment = 'HA', database = 'genbank'),
mutate(H3N2_NA_gisaid_results, subtype = 'H3N2', segment = 'NA', database = 'gisaid'),
mutate(H3N2_NP_genbank_results, subtype = 'H3N2', segment = 'NP', database = 'genbank'),
mutate(H1N1_HA_genbank_results, subtype = 'H1N1', segment = 'HA', database = 'genbank'),
mutate(H1N1_NA_genbank_results, subtype = 'H1N1', segment = 'NA', database = 'genbank'),
mutate(H1N1_NP_genbank_results, subtype = 'H1N1', segment = 'NP', database = 'genbank')
)
ggplot(divergence_results, aes(x = year, y = distance_from_reference,
color = segment, label = isolate_id)) +
geom_point(alpha = 0.5) +
geom_smooth(se = F) +
facet_grid(.~subtype, scales = 'free_x') +
xlab('Year') +
ylab('Amino acid divergence from reference strain') +
scale_color_brewer(type = 'qual') +
theme(legend.position = 'top')
